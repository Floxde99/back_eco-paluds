model AssistantMessage {
  id_assistant_message Int                    @id @default(autoincrement())
  conversation_id      Int
  user_id              Int?
  role                 String                 @db.VarChar(30)
  status               String                 @default("QUEUED") @db.VarChar(30)
  text                 String?                @db.Text
  content              Json?
  tokens_in            Int?                   @default(0)
  tokens_out           Int?                   @default(0)
  error                String?                @db.Text
  metadata             Json?
  created_at           DateTime               @default(now())
  updated_at           DateTime               @updatedAt

  conversation         AssistantConversation  @relation(fields: [conversation_id], references: [id_assistant_conversation])
  user                 User?                  @relation(fields: [user_id], references: [id_user])
  telemetry            AssistantTelemetry[]

  @@index([conversation_id, created_at])
  @@map("assistant_messages")
}
