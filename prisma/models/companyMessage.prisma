model CompanyMessage {
  id_company_message Int      @id @default(autoincrement())
  conversation_id    Int
  company_id         Int
  sender_id          Int
  recipient_id       Int?
  body               String   @db.Text
  attachments        Json?
  status             String   @default("sent") @db.VarChar(30)
  trace_id           String   @db.VarChar(64)
  created_at         DateTime @default(now())
  updated_at         DateTime @updatedAt

  conversation CompanyConversation @relation(fields: [conversation_id], references: [id_company_conversation])
  company      Company             @relation(fields: [company_id], references: [id_company])
  sender       User                @relation("CompanyMessageSender", fields: [sender_id], references: [id_user])
  recipient    User?               @relation("CompanyMessageRecipient", fields: [recipient_id], references: [id_user])

  @@index([conversation_id, created_at])
  @@map("company_messages")
}